Привет читающему.

### Минимум
Этот бот поддерживает 4 команды: /start /help /stats /history, о которых можно почитать в меню бота а также вызвав /help. 
Все остальные текстовые сообщения, которые будут присланы боту, он будет воспринимать как запрос к нахождению фильма с названием по запросу.
Запрос можно составлять на любом языке, но бот всегда отвечает на английском и лучше работает именно при запросах на нем же.

### Как работает
Бот использует API [themoviedb](https://themoviedb.org), а именно запросы к `search`, `movie_id->details`, `movie_id->translations`, `movie_id->watch_providers`. Работает это так:
 - Пользователь пишет название, его бот спрашивает к `search`, оттуда получает название и год, выдает пользователю несколько вариантов на выбор.
 - Пользователь кликает на кнопку с нужным фильмом, что отсылает callback с нужным айдишником фильма
 - Бот по айдишнику собирает следующую инфу:
   - Название в оригинале и год выхода
   - Варианты названия на трех языках (рус, англ, яп.)
   - Список провайдеров, где легально можно посмотреть фильм
 - С этой информацией, он идет в браузер [Duck Duck Go](https://duckduckgo.com) и пишет запросы в разных регионах (соответственно языку) вида `<title> <year> watch on <provider>`
 - Для каждой ссылки с первой страницы поиска, он проверяет что ссылка ведет на нужного провайдера, а также что в заголовке есть слово смотреть или его перевод
 - Т.к. [themoviedb](https://themoviedb.org) и кинопоиск вместе врут (один пишет что там есть фильм, а второй в поисковике отзывается), то он и еще пара провайдеров находятся в стоплисте
P.s. [Duck Duck Go](https://duckduckgo.com) используется потому что у него есть удобный асинхронный питон модуль.

### Про историю
Т.к. хотелось чтобы бот умел обрабатывать запрос вида *Гарри Поттер*, и пользователь имел шанс выбрать нужный фильм, все разбите на две фазы: поиск фильма + поиск предложений.
Поэтому, когда пользователь подтверждает что нашел нужный фильм, информация вида чат-дата-запрос-айдишник_фильма пишется в таблицу `queries`, а название фильма + айдишник пишутся в таблицу `movies` при отсутсвии таковых. 
